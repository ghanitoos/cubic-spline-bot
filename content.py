# -*- coding: utf-8 -*-

START_TEXT = """
๐ ุณูุงู! ุจู ุฑุจุงุช ุขููุฒุด **ุฏุฑููุงุจ ุงุณูพูุงู ูฺฉุนุจ (Cubic Spline)** ุฎูุด ุขูุฏุฏ.

ุงู ุฑุจุงุช ุงฺฉููู ุงุฒ ุฏู ุญุงูุช ูพุดุชุจุงู ูโฺฉูุฏ:
ฑ. **ุณุงุฏู (ุชุงุจุน $y=f(x)$):** ุจุฑุง ุชูุงุจุน ูุนููู (ูุซู $y=x^2$).
ฒ. **ูพุงุฑุงูุชุฑ ($x(t), y(t)$):** ุจุฑุง ููุญูโูุง ูพฺุฏูุ ุจุณุชู ู ุงุดฺฉุงู ููุฏุณ (ูุซู ุฏุงุฑูุ ุงุฑุฏฺฉุ ููุจ).

ุงุฒ ููู ุฒุฑ ุงูุชุฎุงุจ ฺฉูุฏ:
"""

MENUS = {
    "theory": "๐ ุขููุฒุด ุชุฆูุฑ (Numerical Method)",
    "code": "๐ป ุชุญูู ฺฉุฏ ูพุงุชูู",
    "solve": "๐ ุญู ูุณุฆูู (ุขูพููุฏ ูุงู ุง ูุชู)",
    "examples": "๐ ููููู ูุณุงุฆู (Examples)",
    "about": "โน๏ธ ุฏุฑุจุงุฑู ุฑุจุงุช",
    # Sub-menus
    "mode_simple": "๐ ุณุงุฏู (Function)",
    "mode_parametric": "โฐ ูพุงุฑุงูุชุฑ (Parametric)",
    "back": "๐ ุจุงุฒฺฏุดุช"
}

THEORY_TEXT = """
๐ <b>ุขููุฒุด ุฌุงูุน ูุญุงุณุจุงุช ุนุฏุฏ: ุงุณูพูุงู ูฺฉุนุจ (Cubic Spline)</b>
(ุจุง ุชูุฑฺฉุฒ ุจุฑ ูุณุฆูู ููููู ุดูุง)

ูุฑุถ ฺฉูุฏ ูโุฎูุงูู ููุญู ูุฑู ุฑุณู ฺฉูู ฺฉู ุงุฒ ููุงุท ุฒุฑ ุนุจูุฑ ฺฉูุฏ (ุจุฎุด ุงุฒ ูุซุงู ุดูุง):
(0.9, 1.3), (1.3, 1.5), (1.9, 1.85), (2.1, 2.1), ...

๐ข <b>ฺฏุงู ฑ: ูุญุงุณุจู ฺฏุงูโูุง (h)</b>
ุงุจุชุฏุง ูุงุตูู ุงูู ุจู ูุฑ ุฏู ููุทู ูุชูุงู ุฑุง ุญุณุงุจ ูโฺฉูู:
h0 = x1 - x0 = 1.3 - 0.9 = 0.4
h1 = x2 - x1 = 1.9 - 1.3 = 0.6
h2 = x3 - x2 = 2.1 - 1.9 = 0.2
ู ุงู ุขุฎุฑ...

๐ <b>ฺฏุงู ฒ: ุชุนุฑู ูุนุงุฏูู ุจุฑุง ูุฑ ุจุงุฒู</b>
ุฏุฑ ูุฑ ูุงุตููุ ฺฉ ูุนุงุฏูู ุฏุฑุฌู ณ ูุชูุงูุช ุฏุงุฑู:
S_i(x) = a_i + b_i(x-x_i) + c_i(x-x_i)^2 + d_i(x-x_i)^3
ฺฉู ุฏุฑ ุขู:
- a_i ููุงู y_i ุงุณุช (ูุนููู).
- b_i, c_i, d_i ุถุฑุงุจ ูุฌููู ูุณุชูุฏ.

๐ <b>ฺฏุงู ณ: ุดุฑุท ูพูุณุชฺฏ ุชูุนุฑ (Moment Equation)</b>
ูููโุชุฑู ุจุฎุด ุงุณูพูุงูุ ูููุงุฑ ุจูุฏู "ุงูุญูุง" ุงุณุช. ุงู ุดุฑุท ูุง ุฑุง ุจู ฺฉ <b>ุฏุณุชฺฏุงู ูุนุงุฏูุงุช</b> ูโุฑุณุงูุฏ. ุจุฑุง ูุฑ ฺฏุฑู ุฏุงุฎู i ุฑุงุจุทู ุฒุฑ ุจุฑูุฑุงุฑ ุงุณุช:

h_{i-1}M_{i-1} + 2(h_{i-1}+h_i)M_i + h_iM_{i+1} = 6/h_i(y_{i+1}-y_i) - 6/h_{i-1}(y_i-y_{i-1})

ฺฉู ุฏุฑ ุขู M_i ููุงู ูุดุชู ุฏูู (ุชูุนุฑ) ุฏุฑ ููุทู i ุงุณุช (M_i = 2c_i).

๐ <b>ูุซุงู ุนุฏุฏ (ุจุฑุง ููุทู ุฏูู i=1):</b>
ุจุง ุฌุงฺฏุฐุงุฑ ููุงุฏุฑ h0=0.4, h1=0.6:
- ุถุฑุจ M0: ุจุฑุงุจุฑ h0 = 0.4
- ุถุฑุจ M1: ุจุฑุงุจุฑ 2(0.4+0.6) = 2.0
- ุถุฑุจ M2: ุจุฑุงุจุฑ h1 = 0.6

ุณูุช ุฑุงุณุช ูุนุงุฏูู:
= 6/0.6 * (1.85-1.5) - 6/0.4 * (1.5-1.3)
= 10(0.35) - 15(0.2) = 3.5 - 3.0 = 0.5

ูพุณ ูุนุงุฏูู ุฎุท ุงูู ูุงุชุฑุณ ูโุดูุฏ:
0.4 M0 + 2.0 M1 + 0.6 M2 = 0.5

๐ <b>ฺฏุงู ด: ุชุดฺฉู ูุงุชุฑุณ ุณู ูุทุฑ</b>
ฺูู M0=0 ู Mn=0 (ุดุฑุท ุทุจุน)ุ ูุง ฺฉ ุฏุณุชฺฏุงู N-1 ูุนุงุฏูู ู N-1 ูุฌููู ุฏุงุฑู ฺฉู ูุงุชุฑุณ ุถุฑุงุจ ุขู ููุท ุฑู ูุทุฑ ุงุตู ู ุฏู ูุทุฑ ฺฉูุงุฑ ุนุฏุฏ ุฏุงุฑุฏ (Tridiagonal).

๐ <b>ฺฏุงู ต: ุญู ู ุงูุชู ุถุฑุงุจ</b>
ุงู ุฏุณุชฺฏุงู ุจุง ุงูฺฏูุฑุชู ุณุฑุน <b>ุชููุงุณ (TDMA)</b> ุญู ุดุฏู ู ููุงุฏุฑ M ุจุฏุณุช ูโุขูุฏ. ุณูพุณ ุถุฑุงุจ ููุง ูุญุงุณุจู ูโุดููุฏ:
c_i = M_i / 2
d_i = (M_{i+1}-M_i)/(6h_i)
b_i = (y_{i+1}-y_i)/h_i - h_i(2M_i+M_{i+1})/6

ุงฺฉููู ุชุงุจุน S_i(x) ุจุฑุง ุขู ุจุงุฒู ฺฉุงูู ุดุฏู ุงุณุช!
"""

CODE_EXPLANATION = """
๐ป <b>ุขููุฒุด ูุฏู ุจู ูุฏู ฺฉุฏููุณ ูพุงุชูู (Python)</b>
ุจุฑุง ูพุงุฏูโุณุงุฒ ุงู ุฑูุด ุฏุฑ ฺฉุงููพูุชุฑุ ูุง ุฏููุงู ูุฑูููโูุง ุฑุงุถ ุฑุง ุจู ุฒุจุงู ุจุฑูุงููโููุณ ุชุฑุฌูู ูโฺฉูู.

๐ป <b>ูุฑุงุญู ุงูฺฏูุฑุชู ุฏุฑ ฺฉุฏ:</b>

1๏ธโฃ <b>ูุฑูุฏ ุฏุงุฏูโูุง:</b> ุขุฑุงูโูุง <code>x</code> ู <code>y</code> ุฑุง ุชุนุฑู ูโฺฉูู.
2๏ธโฃ <b>ูุญุงุณุจู h:</b> ุจุง ุฏุณุชูุฑ <code>np.diff(x)</code> ูุงุตูู ุจู ุชูุงู ููุงุท ุฑุง ฺฉุฌุง ุญุณุงุจ ูโฺฉูู.
3๏ธโฃ <b>ุณุงุฎุช ูุงุชุฑุณ ุถุฑุงุจ:</b> ฺฉ ุญููู <code>for</code> ูโููุณู ฺฉู ุฑู ููุงุท ุฏุงุฎู (ุงุฒ ฑ ุชุง n-1) ุญุฑฺฉุช ฺฉูุฏ ู ุถุฑุงุจ ูุนุงุฏูู (ฺฉู ุฏุฑ ุจุฎุด ุชุฆูุฑ ุฏุฏุฏ) ุฑุง ูุญุงุณุจู ฺฉูุฏ.
4๏ธโฃ <b>ุญู ุฏุณุชฺฏุงู ูุนุงุฏูุงุช:</b> ฺูู ูุงุชุฑุณ ูุง "ุณู ูุทุฑ" ุงุณุชุ ุงุฒ ุฑูุด ุณุฑุน "ุชููุงุณ" ุงุณุชูุงุฏู ูโฺฉูู ฺฉู ุดุงูู ุฏู ูุฑุญูู ุงุณุช:
   - <b>ูุณุฑ ุฑูุช (Forward):</b> ุถุฑุงุจ ุฑุง ุณุงุฏู ูโฺฉูุฏ.
   - <b>ูุณุฑ ุจุฑฺฏุดุช (Backward):</b> ูุฌูููุงุช (ููุงู c) ุฑุง ูพุฏุง ูโฺฉูุฏ.
5๏ธโฃ <b>ูุญุงุณุจู ุถุฑุงุจ ููุง:</b> ุญุงูุง ฺฉู c (ุงูุญูุง) ุฑุง ุฏุงุฑูุ ุจูู ุถุฑุงุจ (b ู d) ุจุง ูุฑูููโูุง ุณุงุฏู ุจุฏุณุช ูโุขูุฏ.

๐ <b>ฺฉุฏ ฺฉุงูู (ููุฑุงู ุจุง ุชูุถุญุงุช ูุงุฑุณ ุฏุฑ ูุงโุจูโูุง ุฎุทูุท):</b>

<pre><code class="language-python">
import numpy as np

def cubic_spline_natural(x, y):
    # n ุชุนุฏุงุฏ ุจุงุฒูโูุง ุงุณุช (ฺฉ ฺฉูุชุฑ ุงุฒ ุชุนุฏุงุฏ ููุงุท)
    n = len(x) - 1
    
    # ูุญุงุณุจู ูุงุตูู ุจู ููุงุท (h)
    # h[i] ููุงู ูุงุตูู x[i] ุชุง x[i+1] ุงุณุช
    h = np.diff(x)
    
    # --- ูุฑุญูู ฑ: ุชุดฺฉู ุฏุณุชฺฏุงู ูุนุงุฏูุงุช ---
    # ูุง ุฏูุจุงู c ูุณุชู (ฺฉู ูุตู ูุดุชู ุฏูู ุงุณุช)
    # ุขุฑุงู alpha ููุงู ุณูุช ุฑุงุณุช ูุนุงุฏูู ูุงุชุฑุณ ุงุณุช
    alpha = np.zeros(n)
    for i in range(1, n):
        # ุงู ูุฑููู ุฏููุงู ููุงู "ุชูุงุถู ุชูุณู ุดุฏู" ุงุณุช ฺฉู ุฏุฑ ุชุฆูุฑ ุฏุฏู
        term1 = (3/h[i]) * (y[i+1] - y[i])
        term2 = (3/h[i-1]) * (y[i] - y[i-1])
        alpha[i] = term1 - term2
    
    # --- ูุฑุญูู ฒ: ุญู ุฏุณุชฺฏุงู (ุงูฺฏูุฑุชู ุชููุงุณ) ---
    # ุขุฑุงูโูุง l, mu, z ุจุฑุง ูฺฏูุฏุงุฑ ููุงุฏุฑ ูููุช ุฏุฑ ุฑูุด ุญุฐู ูุณุชูุฏ
    l = np.zeros(n+1)
    mu = np.zeros(n+1)
    z = np.zeros(n+1)
    c = np.zeros(n+1)
    
    # ุดุฑุท ูุฑุฒ ุทุจุน: ูุดุชู ุฏูู (ุงูุญูุง) ุฏุฑ ููุทู ุดุฑูุน ุตูุฑ ุงุณุช
    l[0] = 1.0
    mu[0] = 0.0
    z[0] = 0.0
    
    # ูุณุฑ ุฑูุช: ุณุงุฏูโุณุงุฒ ูุงุชุฑุณ ุงุฒ ุจุงูุง ุจู ูพุงู
    for i in range(1, n):
        l[i] = 2*(x[i+1]-x[i-1]) - h[i-1]*mu[i-1]
        mu[i] = h[i] / l[i]
        z[i] = (alpha[i] - h[i-1]*z[i-1]) / l[i]
        
    # ุดุฑุท ูุฑุฒ ุทุจุน: ูุดุชู ุฏูู ุฏุฑ ููุทู ูพุงุงู ูู ุตูุฑ ุงุณุช
    l[n] = 1.0
    z[n] = 0.0
    c[n] = 0.0
    
    # ูุณุฑ ุจุฑฺฏุดุช: ูพุฏุง ฺฉุฑุฏู c ุงุฒ ูพุงู ุจู ุจุงูุง
    for j in range(n-1, -1, -1):
        c[j] = z[j] - mu[j] * c[j+1]
        
    # --- ูุฑุญูู ณ: ูุญุงุณุจู ุถุฑุงุจ ููุง ูุนุงุฏูู ุฏุฑุฌู ณ ---
    # ูุนุงุฏูู: S(x) = a + b(dx) + c(dx)^2 + d(dx)^3
    b = np.zeros(n)
    d = np.zeros(n)
    a = y[:-1] # ุถุฑุจ ุซุงุจุช (a) ููุงู ููุฏุงุฑ ุชุงุจุน (y) ุฏุฑ ููุทู ุดุฑูุน ุงุณุช
    
    for i in range(n):
        # ูุฑูููโูุง ุชุจุฏู c ุจู b ู d
        b[i] = (y[i+1]-y[i])/h[i] - h[i]*(c[i+1] + 2*c[i])/3
        d[i] = (c[i+1]-c[i])/(3*h[i])
        
    return a, b, c[:-1], d

# === ุงุฌุฑุง ฺฉุฏ ุจุง ุฏุงุฏูโูุง ูุงูุน ุดูุง ===
if __name__ == "__main__":
    # ุฏุงุฏูโูุง ูุณุฆูู (ูพุฑููุงู ููุฑุฏ ูุธุฑ)
    x_data = np.array([0.9, 1.3, 1.9, 2.1, 2.6, 3.0, 3.9, 4.4, 4.7, 5.0, 
                       6.0, 7.0, 8.0, 9.2, 10.5, 11.3, 11.6, 12.0, 12.6, 13.0, 13.3])
    y_data = np.array([1.3, 1.5, 1.85, 2.1, 2.6, 2.7, 2.4, 2.15, 2.05, 2.1, 
                       2.25, 2.3, 2.25, 1.95, 1.4, 0.9, 0.7, 0.6, 0.5, 0.4, 0.25])

    # ูุฑุงุฎูุงู ุชุงุจุน ุญูโฺฉููุฏู
    a, b, c, d = cubic_spline_natural(x_data, y_data)

    print(f"{'ุจุงุฒู x':&lt;15} | {'ูุนุงุฏูู ฺูุฏุฌูููโุง S(x)':&lt;50}")
    print("-" * 70)
    
    # ููุงุด ูุนุงุฏูู ณ ุจุงุฒู ุงูู ุจู ุนููุงู ููููู
    for i in range(3):
        eq = f"{a[i]:.2f} + {b[i]:.2f}(x-{x_data[i]}) + {c[i]:.2f}(x-{x_data[i]})^2 + {d[i]:.2f}(x-{x_data[i]})^3"
        print(f"[{x_data[i]}, {x_data[i+1]}]     | {eq}")
</code></pre>

๐ก <b>ูฺฉุชู:</b> ูโุชูุงูุฏ ุงู ฺฉุฏ ุฑุง ฺฉูพ ฺฉุฑุฏู ู ุฏุฑ ุณุณุชู ุฎูุฏ ุงุฌุฑุง ฺฉูุฏ ุชุง ุชูุงู ุถุฑุงุจ ุฑุง ุจุจูุฏ.
"""

CHOOSE_MODE_TEXT = """
โ๏ธ **ุงูุชุฎุงุจ ุญุงูุช ุญู:**

ูุทูุง ููุน ูุณุฆูู ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ:
ฑ. **ุณุงุฏู:** ุจุฑุง ุชูุงุจุน ุฑุงุถ ูุนููู (x ุจุงุฏ ุตุนูุฏ ุจุงุดุฏ).
ฒ. **ูพุงุฑุงูุชุฑ:** ุจุฑุง ุดฺฉูโูุง ฺฏุฑุงูฺฉุ ุงุฑุฏฺฉุ ุฏุงุฑู ู ... (ุชุฑุชุจ ููุงุท ููู ุงุณุชุ ูู ููุฏุงุฑ x).
"""

SOLVE_PROMPT_SIMPLE = """
๐ **ุญู ูุณุฆูู (ุญุงูุช ุณุงุฏู $y=f(x)$)**

ููุงุท ุฎูุฏ ุฑุง ุงุฑุณุงู ฺฉูุฏ (x ุจุงุฏ ุตุนูุฏ ุจุงุดุฏ):
```
0.0 1.0
1.0 2.0
2.0 1.0
3.0 0.5
```
"""

SOLVE_PROMPT_PARAMETRIC = """
๐ **ุญู ูุณุฆูู (ุญุงูุช ูพุงุฑุงูุชุฑ $x(t), y(t)$)**

ููุงุท ุฑุง ุจู ุชุฑุชุจ ุฑุณู ูุงุฑุฏ ฺฉูุฏ (ูโุชูุงูุฏ ููุญู ุจุณุชู ุจุงุดุฏ):
ูุซุงู (ุฏุงุฑู):
```
1 0
0 1
-1 0
0 -1
1 0
```
"""

EXAMPLES_TEXT = """
๐ **ููููู ูุณุงุฆู ุจุฑุง ุชูุฑู**

ูุทูุง ฺฉ ููุฑุฏ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ ุชุง ูููููโูุง ุฑุง ุจุจูุฏ:
"""

EXAMPLES_SIMPLE = """
๐ **ูุซุงูโูุง ุณุงุฏู (Function)**

๐น **ฺฉูู:**
```
0.0 1.0
1.0 2.0
2.0 1.0
3.0 0.5
```
"""

EXAMPLES_PARAMETRIC = """
โฐ **ูุซุงูโูุง ูพุงุฑุงูุชุฑ (Parametric)**

๐น **ุงุฑุฏฺฉ ูพุฑูุฏู (Flying Duck):**
```
0.0 2.0
0.5 2.2
1.0 3.0
1.5 2.8
2.0 2.0
2.5 1.5
3.0 1.0
5.0 1.5
7.0 1.2
9.0 1.0
10.0 2.0
```

๐น **ููุจ (Heart Shape):**
```
0 -1
0.5 0.5
1 1
0 0.5
-1 1
-0.5 0.5
0 -1
```
"""

ERROR_FILE_FORMAT = "โ ูุฑูุช ูุฑูุฏ ุตุญุญ ูุณุช. ูุทูุง ูุทูุฆู ุดูุฏ ฺฉู ุฏุฑ ูุฑ ุฎุท ุฏู ุนุฏุฏ (x ู y) ูุฌูุฏ ุฏุงุฑุฏ."
ERROR_SORTED = "โ ุฎุทุง: ุฏุฑ ุญุงูุช ุณุงุฏูุ ููุงุฏุฑ x ุจุงุฏ ุจู ุตูุฑุช ุตุนูุฏ ูุฑุชุจ ุดุฏู ุจุงุดูุฏ. ุงฺฏุฑ ุดฺฉู ูพฺุฏู ุงุณุชุ ุงุฒ ุญุงูุช **ูพุงุฑุงูุชุฑ** ุงุณุชูุงุฏู ฺฉูุฏ."
ERROR_MIN_POINTS = "โ ุฎุทุง: ุญุฏุงูู ุจู ณ ููุทู ูุงุฒ ุฏุงุฑุฏ."
